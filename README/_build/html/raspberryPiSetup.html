

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Raspberry Pi tracking and related networking setup &mdash; Recording PC Setup 0.1 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="Recording PC Setup 0.1 documentation" href="index.html"/>
        <link rel="next" title="Recording PC setup for Data Processing" href="recordingPCforDataProcessing.html"/>
        <link rel="prev" title="Recording PC setup for Data Acquisition" href="recordingPCandOpenEphysGUI.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> Recording PC Setup
          

          
          </a>

          
            
            
              <div class="version">
                0.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="recordingPCandOpenEphysGUI.html">Recording PC setup for Data Acquisition</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="">Raspberry Pi tracking and related networking setup</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#setting-up-raspberry-pi-with-camera-for-tracking">Setting up Raspberry Pi with camera for tracking</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#assembling-raspberry-pi-camera-module-and-coaxial-cable-plug">Assembling Raspberry Pi Camera Module and Coaxial Cable Plug</a></li>
<li class="toctree-l3"><a class="reference internal" href="#installing-raspberry-pi-os-raspbian">Installing Raspberry Pi OS: Raspbian</a></li>
<li class="toctree-l3"><a class="reference internal" href="#install-necessary-libraries-on-raspberry-pi">Install necessary libraries on Raspberry Pi</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#setting-up-raspberry-pi-networking-with-recording-pc">Setting up Raspberry Pi networking with recording PC</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#configuring-raspberry-pi">Configuring Raspberry Pi</a></li>
<li class="toctree-l3"><a class="reference internal" href="#configuring-the-recording-pc">Configuring the Recording PC</a></li>
<li class="toctree-l3"><a class="reference internal" href="#configure-ssh-keys-to-avoid-password-requests">Configure SSH keys to avoid Password requests</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#making-copies-of-raspberry-pis">Making copies of Raspberry Pis</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="recordingPCforDataProcessing.html">Recording PC setup for Data Processing</a></li>
<li class="toctree-l1"><a class="reference internal" href="howToUseTheseScripts.html">Tutorial for using Open Ephys Scripts</a></li>
<li class="toctree-l1"><a class="reference internal" href="wirelessRewardSetup.html">FEEDER setup</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">Recording PC Setup</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
    <li>Raspberry Pi tracking and related networking setup</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/raspberryPiSetup.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="raspberry-pi-tracking-and-related-networking-setup">
<span id="raspberrypisetup"></span><h1>Raspberry Pi tracking and related networking setup<a class="headerlink" href="#raspberry-pi-tracking-and-related-networking-setup" title="Permalink to this headline">¶</a></h1>
<div class="section" id="setting-up-raspberry-pi-with-camera-for-tracking">
<h2>Setting up Raspberry Pi with camera for tracking<a class="headerlink" href="#setting-up-raspberry-pi-with-camera-for-tracking" title="Permalink to this headline">¶</a></h2>
<p>This tutorial is based on setting up <a class="reference external" href="https://www.raspberrypi.org/products/raspberry-pi-3-model-b/">Raspberry Pi 3 Model B</a> with <a class="reference external" href="https://www.raspberrypi.org/products/camera-module-v2/">Camera Module V2</a>.</p>
<div class="section" id="assembling-raspberry-pi-camera-module-and-coaxial-cable-plug">
<h3>Assembling Raspberry Pi Camera Module and Coaxial Cable Plug<a class="headerlink" href="#assembling-raspberry-pi-camera-module-and-coaxial-cable-plug" title="Permalink to this headline">¶</a></h3>
<p>The Raspberry Pi (RPi) Camera Module is usually bought and fitted separately to the RPi board. The Coaxial Cable Plug is necessary to send signals to the Open Ephys Acquisition Board each time a frame is captured.</p>
<p>Preferably the camera should be used with HDMI cable extension sold on <a class="reference external" href="https://shop.pimoroni.com/products/pi-camera-hdmi-cable-extension">Pimoroni website</a>. This allows the camera to be positioned distant from the RPi and the angle manipulated more comfortably. Instructions for its assembly should be available from the provider.</p>
<p>Regardless of whether the HDMI cable extension is used or not, a board with the flat camera cable attached will need to be assembled to the RPi board. Attach the flat cable to the interface right next to the HDMI output. Look at the interface and make sure the metal contacts on the cable touch the metal contact on the RPi interface. See image below. Push down on the clip on the interface to mechanically secure the connection.</p>
<img alt="_images/RPi_Setup.jpg" src="_images/RPi_Setup.jpg" />
<p>The Standard Coaxial Cable plug can be soldered to the RPi GPIO Pinout. See the above image. On Raspberry Pi 3 Model B the Ground from the Coaxial plug should be soldered on the 5th pin on the 2nd row and the Other contact from the Coaxial plug to the 6th pin in the same row. That is if rows and pins are counted from the RPi corner diagonal from the LAN port.</p>
<p>More clearly, the Ground from Coaxial plug must be soldered to any of the <strong>Ground pins</strong> on RPi and the other contact from the Coaxial plug must be soldered to <strong>Physical pin 11</strong>. If a different Physical pin is used than nr 11, then changes should be made in the tracking script (tracking.py, ttlPin variable). To identify the identity of each pin, use the <a class="reference external" href="https://pinout.xyz/">https://pinout.xyz/</a> information.</p>
</div>
<div class="section" id="installing-raspberry-pi-os-raspbian">
<span id="installingraspbian"></span><h3>Installing Raspberry Pi OS: Raspbian<a class="headerlink" href="#installing-raspberry-pi-os-raspbian" title="Permalink to this headline">¶</a></h3>
<p>Download <strong>Raspbian Jessie With Pixel</strong> (Here used version 4.4) from <a class="reference external" href="ttps://www.raspberrypi.org/downloads/raspbian/">Raspberry website</a>. Unpack the downloaded <em>.zip</em> file with <code class="docutils literal"><span class="pre">Archive</span> <span class="pre">Manager</span></code> to get access to the <em>.img</em> file.</p>
<p>Download <strong>Etcher</strong> from this <a class="reference external" href="https://etcher.io/">website</a>. Unpack the downloaded <em>.zip</em> and run (double-click) the Etcher <em>.AppImage</em>. Select the Raspbian <em>.img</em> file and your inserted microSD card. Write the image (<em>Flash</em> button).</p>
<p>Insert the microSD card into Raspberry Pi.</p>
</div>
<div class="section" id="install-necessary-libraries-on-raspberry-pi">
<h3>Install necessary libraries on Raspberry Pi<a class="headerlink" href="#install-necessary-libraries-on-raspberry-pi" title="Permalink to this headline">¶</a></h3>
<p>Connect to RPi a keyboard, mouse and monitor.</p>
<p>This tutorial instructs you to connect the RPi to the internet using the same network connection as is used for your recording PC, if you used the following method to set it up: <a class="reference internal" href="recordingPCandOpenEphysGUI.html#recpcnetworkinterfaces"><span>Connect to the local network</span></a>. This means you will not be able to use the Recording PC to access the internet, while you work through the part &#8220;Install necessary libraries on Raspberry Pi&#8221;. If you can use another means of achieving network connection on the RPi, you can ignore steps in this part relating to <strong>interfaces</strong> file. Otherwise, connect the RPi to the network with the same ethernet cable as you were so far using on the Recording PC.</p>
<p>Add <code class="xref download docutils literal"><span class="pre">this</span> <span class="pre">script</span> <span class="pre">(install-opencv.sh)</span></code> and the file <code class="docutils literal"><span class="pre">/etc/network/interfaces</span></code> (as set up on the Recording PC in this guide: <a class="reference internal" href="recordingPCandOpenEphysGUI.html#recpcnetworkinterfaces"><span>Connect to the local network</span></a>) to the RPi <em>Home folder</em> with a USB stick.</p>
<p>You may need to edit the <code class="docutils literal"><span class="pre">interfaces</span></code> file in your RPi home folder. Run the terminal command <code class="docutils literal"><span class="pre">ifconfig</span></code> on the RPi and make a note of the first device on the list. Devices are aligned to the left column. This is likely <code class="docutils literal"><span class="pre">eth0</span></code>. Replace the device name <code class="docutils literal"><span class="pre">enp2s0</span></code> in the <code class="docutils literal"><span class="pre">interfaces</span> <span class="pre">file</span></code> with the device you saw in <code class="docutils literal"><span class="pre">ifconfig</span></code> output. You can use a simple text editor by double clicking on the <code class="docutils literal"><span class="pre">interfaces</span></code> file in your home folder, making the changes and saving it.</p>
<p>Apply the newly created <code class="docutils literal"><span class="pre">interfaces</span></code> file in the Raspberry Pi with terminal commands:</p>
<div class="highlight-none"><div class="highlight"><pre>sudo mv /etc/network/interfaces /etc/network/interfaces_old        # Makes a copy of the original version
sudo mv ~/interfaces /etc/network/interfaces       # Replaces the previous interfaces file
</pre></div>
</div>
<p>Reboot the Raspberry Pi for network changes to take effect.</p>
<p>Now update the RPi with terminal commands:</p>
<div class="highlight-none"><div class="highlight"><pre>sudo apt-get update        # Fetches the list of available updates
sudo apt-get upgrade       # Strictly upgrades the current packages
sudo apt-get dist-upgrade  # Installs updates (new ones)
</pre></div>
</div>
<p>Install OpenCV using the <code class="docutils literal"><span class="pre">install-opencv.sh</span></code> script. Right click on <code class="docutils literal"><span class="pre">install-opencv.sh</span></code> and select Properties. Open Permissions tab and make sure all three Access Control settings (View content, Change content, Exectue) are set to Anyone. Click OK to close the window. Now run the script using terminal command <code class="docutils literal"><span class="pre">./install-opencv.sh</span></code>.</p>
<p>To install use the following terminal commands, as copied from <a class="reference external" href="https://github.com/MonsieurV/ZeroMQ-RPi">https://github.com/MonsieurV/ZeroMQ-RPi</a></p>
<div class="highlight-none"><div class="highlight"><pre>sudo apt-get install libtool pkg-config build-essential autoconf automake
wget https://github.com/jedisct1/libsodium/releases/download/1.0.3/libsodium-1.0.3.tar.gz
tar -zxvf libsodium-1.0.3.tar.gz
cd libsodium-1.0.3/
./configure
make
sudo make install
cd ~/
wget http://download.zeromq.org/zeromq-4.1.3.tar.gz
tar -zxvf zeromq-4.1.3.tar.gz
cd zeromq-4.1.3/
./configure
make
cd ~/
sudo make install
sudo ldconfig
sudo apt-get install python-dev
sudo pip install pyzmq
</pre></div>
</div>
<p>Install packages necessary to run the tracking and calibration scripts</p>
<div class="highlight-none"><div class="highlight"><pre>sudo apt-get install python-scipy
</pre></div>
</div>
<p>Camera needs to be enabled in RPi settings. You can do this by accessing RPi settings via terminal command <code class="docutils literal"><span class="pre">sudo</span> <span class="pre">raspi-config</span></code> and choosing <em>Interfacing Options</em> with arrow keys and pressing Enter. Select <em>Camera</em> option and choose to <em>Enable</em> it. Reboot the RPi.</p>
<p>Now the RPi is ready to use the tracking scripts.</p>
</div>
</div>
<div class="section" id="setting-up-raspberry-pi-networking-with-recording-pc">
<h2>Setting up Raspberry Pi networking with recording PC<a class="headerlink" href="#setting-up-raspberry-pi-networking-with-recording-pc" title="Permalink to this headline">¶</a></h2>
<p>This part describes setting up networking between the recording PC and one or multiple Raspberry Pis. This setup is based on having two network adapters on the Recording PC. One of them connected to the internet, as in this guide: <a class="reference internal" href="recordingPCandOpenEphysGUI.html#recpcnetworkinterfaces"><span>Connect to the local network</span></a>. The other can be a USB network adapter or a PCIe card that is then connected to the RPi or to a network switch that has multiple RPis connected to it. (Ubuntu should recognise and automatically install any necessary drivers for a network adapter. This can be verified if a new device shows up in <code class="docutils literal"><span class="pre">ifconfig</span></code>) When connecting multiple RPis, the setup is identical, only that each RPi has a different static IP address assigned (see below on how to change <code class="docutils literal"><span class="pre">dhcpcd.conf</span></code>).</p>
<div class="section" id="configuring-raspberry-pi">
<h3>Configuring Raspberry Pi<a class="headerlink" href="#configuring-raspberry-pi" title="Permalink to this headline">¶</a></h3>
<p>SSH needs to be enabled. You can do this by accessing RPi settings via terminal command <code class="docutils literal"><span class="pre">sudo</span> <span class="pre">raspi-config</span></code> and choosing <em>Interfacing Options</em> with arrow keys and pressing Enter. Select <em>SSH</em> option and choose to <em>Enable</em> it. Reboot Raspberry Pi.</p>
<p>Restore the original interfaces file with the following commands</p>
<div class="highlight-none"><div class="highlight"><pre>sudo mv /etc/network/interfaces /etc/network/interfaces_MainLine
sudo mv /etc/network/interfaces_old /etc/network/interfaces
</pre></div>
</div>
<p>To set up a static IP address, you will need to edit the <code class="docutils literal"><span class="pre">dhcpcd.conf</span></code>. You can do this with the following terminal command <code class="docutils literal"><span class="pre">sudo</span> <span class="pre">leafpad</span> <span class="pre">/etc/dhcpcd.conf</span></code>. Add the following lines to the end of this file and Save it.</p>
<div class="highlight-none"><div class="highlight"><pre># Static IP for connection to Recording PC
interface eth0
static ip_address=10.0.0.20/24
static routers=10.0.0.1
static domain_name_servers=10.0.0.1
</pre></div>
</div>
<p>Here again the <code class="docutils literal"><span class="pre">interface</span></code> variable is set to <code class="docutils literal"><span class="pre">eth0</span></code>. This is likely the primary ethernet adapter identity on your RPi, but you can check this using the <code class="docutils literal"><span class="pre">ifconfig</span></code> terminal command. The first value on the left column should be used as the <code class="docutils literal"><span class="pre">interface</span></code> value in <code class="docutils literal"><span class="pre">dhcpcd.conf</span></code>.</p>
<p>Note that if you have multiple RPis connected to the Recording PC through a switch, they should have different <code class="docutils literal"><span class="pre">static</span> <span class="pre">ip_address</span></code> values in the <code class="docutils literal"><span class="pre">dhcpcd.conf</span></code>. These could be for example <code class="docutils literal"><span class="pre">10.0.0.20/24</span></code> and <code class="docutils literal"><span class="pre">10.0.0.21/24</span></code>. <strong>Make a note of the IP entered on each RPi, as you will need these to connect to RPi from the Recroding PC.</strong></p>
<p>The <code class="docutils literal"><span class="pre">interfaces</span></code> file will also need to be slightly edited. Open it using the terminal command <code class="docutils literal"><span class="pre">sudo</span> <span class="pre">leafpad</span> <span class="pre">/etc/network/interfaces</span></code>. Find the line that says <code class="docutils literal"><span class="pre">iface</span> <span class="pre">eth0</span> <span class="pre">inet</span> <span class="pre">manual</span></code>, or whatever the correct primary network adapter identity is. Put a <code class="docutils literal"><span class="pre">#</span></code> in front of that line, commenting it out. Just below the line add a new line: <code class="docutils literal"><span class="pre">auto</span> <span class="pre">eth0</span></code> or whatever the correct primary network adapter identity is. Save the file. So the two edited lines in the file would look like this:</p>
<div class="highlight-none"><div class="highlight"><pre># iface eth0 inet manual
auto eth0
</pre></div>
</div>
<p>With this setup the SSH login may be slow. This can be fixed by editing the <code class="docutils literal"><span class="pre">sshd_config</span></code> file. Open it with terminal command <code class="docutils literal"><span class="pre">sudo</span> <span class="pre">leafpad</span> <span class="pre">/etc/ssh/sshd_config</span></code> and add this line to the very end:</p>
<div class="highlight-none"><div class="highlight"><pre>UseDNS no
</pre></div>
</div>
<p>Now after you restart the RPi, it should be ready for connecting to the Recording PC and to be used with the Recording Manager.</p>
</div>
<div class="section" id="configuring-the-recording-pc">
<h3>Configuring the Recording PC<a class="headerlink" href="#configuring-the-recording-pc" title="Permalink to this headline">¶</a></h3>
<p>These instructions are based on <a class="reference external" href="https://www.thomas-krenn.com/en/wiki/Two_Default_Gateways_on_One_System">this blog post</a>.</p>
<p>Changes need to be made to the <code class="docutils literal"><span class="pre">interfaces</span></code> file. Open this using terminal command <code class="docutils literal"><span class="pre">sudo</span> <span class="pre">gedit</span> <span class="pre">/etc/network/interfaces</span></code>. Add the following lines to the end of the file:</p>
<div class="highlight-none"><div class="highlight"><pre># Network adapter interfacing with RPis
allow-hotplug eth1
iface eth1 inet static
address 10.0.0.10
netmask 255.255.255.0
gateway 10.0.0.1
dns-nameservers 8.8.8.8
post-up ip route add 10.0.0.0/24 dev eth1 src 10.0.0.10 table rt2
post-up ip route add default via 10.0.0.1 dev eth1 table rt2
post-up ip rule add from 10.0.0.10/32 table rt2
post-up ip rule add to 10.0.0.10/32 table rt2
</pre></div>
</div>
<p>Note that the word <code class="docutils literal"><span class="pre">eth1</span></code> occurs 4 times in this block. This needs to be replaced by the identity of the network adapter that is connected to the RPis. You can find the identiy with the terminal command <code class="docutils literal"><span class="pre">ifconfig</span></code> and checking which adapter identiy (left column) appears and disappears as you change as you connect and disconnect the network adapter from the PC. It should be the second on the list.</p>
<p>The <code class="docutils literal"><span class="pre">rt_tables</span></code> file also needs to be edited. Open it with terminal command <code class="docutils literal"><span class="pre">sudo</span> <span class="pre">gedit</span> <span class="pre">/etc/iproute2/rt_tables</span></code>. Add the following line to the very end of the file:</p>
<div class="highlight-none"><div class="highlight"><pre>1 rt2
</pre></div>
</div>
<p>Now after you restart the Recording PC you should be able to connect to the RPi using the terminal command <code class="docutils literal"><span class="pre">ssh</span> <span class="pre">pi&#64;10.0.0.20</span></code> or whatever was your chosen static IP address for the RPi. The first time you do this from the Recording PC, it may say <em>The authenticity of host &#8216;10.0.0.20 (10.0.0.20)&#8217; can&#8217;t be established. -//- Are you sure you want to continue connecting (yes/no)?*</em> Type <strong>yes</strong> and hit Enter. The default password for the RPi is <code class="docutils literal"><span class="pre">raspberry</span></code>.</p>
</div>
<div class="section" id="configure-ssh-keys-to-avoid-password-requests">
<h3>Configure SSH keys to avoid Password requests<a class="headerlink" href="#configure-ssh-keys-to-avoid-password-requests" title="Permalink to this headline">¶</a></h3>
<p>This is necessary for the Recording Manager to successfully interact with the RPi. The following steps are based on <a class="reference external" href="https://www.raspberrypi.org/documentation/remote-access/ssh/passwordless.md">this guide</a>.</p>
<p>Generate an SSH key on Recording PC with terminal command <code class="docutils literal"><span class="pre">ssh-keygen</span> <span class="pre">-t</span> <span class="pre">rsa</span> <span class="pre">-C</span> <span class="pre">recpc&#64;pi</span></code>. Use the default location to save the key by pressing Enter. Leave the passphrase empty by pressing Enter.</p>
<p>Open terminal on Recording PC and enter the connect to your RPi using SSH with command <code class="docutils literal"><span class="pre">ssh</span> <span class="pre">pi&#64;10.0.0.20</span></code> and enter <code class="docutils literal"><span class="pre">raspberry</span></code> as password. Enter this command in the terminal where you opened the SSH connection <code class="docutils literal"><span class="pre">install</span> <span class="pre">-d</span> <span class="pre">-m</span> <span class="pre">700</span> <span class="pre">~/.ssh</span></code>.</p>
<p>Now exit the SSH session or open a new terminal on Recording PC and enter this command <code class="docutils literal"><span class="pre">cat</span> <span class="pre">~/.ssh/id_rsa.pub</span> <span class="pre">|</span> <span class="pre">ssh</span> <span class="pre">pi&#64;10.0.0.20</span> <span class="pre">'cat</span> <span class="pre">&gt;&gt;</span> <span class="pre">.ssh/authorized_keys'</span></code>. Use the correct IP address (the numbers: <code class="docutils literal"><span class="pre">10.0.0.20</span></code>) in that command for the IP address of the RPi you are connecting to. Enter the password <code class="docutils literal"><span class="pre">raspberry</span></code> for your RPi.</p>
<p>Now your RPi should be able to connect to the RPi via SSH without a password.</p>
</div>
</div>
<div class="section" id="making-copies-of-raspberry-pis">
<span id="duplicatingrpis"></span><h2>Making copies of Raspberry Pis<a class="headerlink" href="#making-copies-of-raspberry-pis" title="Permalink to this headline">¶</a></h2>
<p>Once one Raspberry Pi has been set up and configured based on the instructions above, it is best to set the others up as simple copies of the first one. To do this, you can use linux built in method to make a virtual copy of the SD drive on your Recording PC or other computer that has SD card reader and then rewrite it onto a new SD card using <strong>Etcher</strong> as during the initial installation of Raspbian. You will only need to make one change separately for each RPi.</p>
<p>Insert your SD card and find out its identifier in Ubuntu using the terminal command <code class="docutils literal"><span class="pre">sudo</span> <span class="pre">fdisk</span> <span class="pre">-l</span></code>. If you are unsure of which device name (something like <code class="docutils literal"><span class="pre">/dev/mmcblk0</span></code>) is your RPi SD card, you can check be removing and re-inserting to establish which drive/card appears and disapperas. Drive/card identifiers can have endings indicating paritions, in this case you may have <code class="docutils literal"><span class="pre">/dev/mmcblk0p0</span></code> and <code class="docutils literal"><span class="pre">/dev/mmcblk0p1</span></code>. When using the drive identifier in the commands, leave out the <code class="docutils literal"><span class="pre">p0</span></code> or <code class="docutils literal"><span class="pre">p1</span></code> ending, as you want to copy all partitions on the card.</p>
<p>Before you continue, make sure you have unmounted all partitions of the SD card. Using your correct drive identifier, use the following terminal commands:</p>
<div class="highlight-none"><div class="highlight"><pre>sudo umount /dev/mmcblk0p0
sudo umount /dev/mmcblk0p1
sudo umount /dev/mmcblk0
</pre></div>
</div>
<p>Ensure that your PC has as much free space as your SD cards total capacity, then use the following terminal command to make a virtual copy of the card, where you need to use the correct drive identifier:</p>
<div class="highlight-none"><div class="highlight"><pre>sudo dd if=/dev/mmcblk0 of=~/RPi-SDcard-Copy.img
</pre></div>
</div>
<p>This should put the virtual copy to your home folder and name it <code class="docutils literal"><span class="pre">RPi-SDcard-Copy.img</span></code>. If you wish to save it elsewhere, you can specify the full path including the file name, instead of the <code class="docutils literal"><span class="pre">~/RPi-SDcard-Copy.img</span></code> in the above command.</p>
<p>Now remove the original RPi SD card from the computer and replace it with a new one. You can now proceed to write the newly made copy of the original SD card onto the new SD card using Etcher, as you did at this part of the guide: <a class="reference internal" href="#installingraspbian"><span>Installing Raspberry Pi OS: Raspbian</span></a>. You just need to choose the newly created <code class="docutils literal"><span class="pre">RPi-SDcard-Copy.img</span></code> to write instead of the Raspbian OS <em>.img</em> file you used when installing Raspbian originally.</p>
<p>Once the writing is done, you need to access the newly created SD card. You may need to re-insert it to remount it (Always use eject option if possible, before removing SD cards). You need to edit the <code class="docutils literal"><span class="pre">/etc/dhcpcd.conf</span></code> file on the SD card. Navigate to the SD card directory, go to <code class="docutils literal"><span class="pre">etc</span></code> folder. Open terminal in that folder by right clicking into the folder and choosing <em>Open in Terminal</em>. Use this command to open the file in text editor `` sudo gedit dhcpcd.conf``. You need to change one of the lines you added to the <code class="docutils literal"><span class="pre">dhcpcd.conf</span></code> file originally when setting up networking for the RPi. Find the line that says <code class="docutils literal"><span class="pre">static</span> <span class="pre">ip_address=10.0.0.20/24</span></code>. Edit the IP address to what the address you wish the RPi with this SD card would have, e.g. <code class="docutils literal"><span class="pre">static</span> <span class="pre">ip_address=10.0.0.21/24</span></code>. Save the text file.</p>
<p>You can now remove the SD card (safely with after ejecting in Ubuntu) and simply plug it into a new Raspberry Pi. It should work perfectly as the one before, only you will need to use the newly set IP address to connect to it. Make sure you test if the SSH connection can be established, with terminal command from Recording PC <code class="docutils literal"><span class="pre">ssh</span> <span class="pre">pi&#64;10.0.0.21</span></code>. At first time of running, it may say <em>The authenticity of host &#8216;10.0.0.21 (10.0.0.21)&#8217; can&#8217;t be established. -//- Are you sure you want to continue connecting (yes/no)?*</em> Type <strong>yes</strong> and hit Enter.</p>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="recordingPCforDataProcessing.html" class="btn btn-neutral float-right" title="Recording PC setup for Data Processing" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="recordingPCandOpenEphysGUI.html" class="btn btn-neutral" title="Recording PC setup for Data Acquisition" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, Sander Tanni.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'0.1',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>